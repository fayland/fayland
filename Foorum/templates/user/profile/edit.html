[% USE FillInForm %]
[% UNLESS c.req.method == 'POST';
    data = {
        homepage  => user_details.homepage,
        nickname  => c.user.nickname,
        gender    => c.user.gender,
        lang      => c.user.lang,
        year      => year, month => month, day => day,
    };
END; %]
[% FILTER fillinform fdat => data || c.req.params %]
<div class='one'>
<table align='center'>
	<tbody>
	<form method='post'>
	<tr class='title'><td colspan='2'>Profile Edit</td></tr>
    <tr class='misc1'><td width='20%' align='right'>Username:</td><td>[% c.user.username %] ( <a href='/profile/change_username'>Change Username</a>, <a href='/profile/change_password'>Change Password</a>, <a href='/profile/change_email'>Change Email</a>)
	</td></tr>
    <tr class='misc1'><td align='right'>Nickname:</td><td><input type='text' name='nickname' size='24' />
	[% IF c.form.error('nickname') %]
	the length of nickname should be more than 4 and less than 20
	[% END %]
	</td></tr>
	<tr class='misc2'><td align='right'>Preferable Language:</td><td><select name='lang'><option value='en'>English</option><option value='cn'>简体中文</option>
    </select>
	[% IF c.form.error('lang') %]
	    [% c.loc("Illegal Request.") %]
	[% END %]
	</td></tr>
    <tr class='misc1'><td align='right'>Gender:</td><td><select name='gender'><option value=''>Secret</option><option value='M'>Male</option><option value='F'>Female</option>
</select>
	[% IF c.form.error('gender') %]
	    Please select your gender.
	[% END %]
	</td></tr>
	<tr class='misc2'><td align='right'>Birthday:</td><td><input type='text' name='year' size='4' maxlength='4' /> / <input type='text' name='month' size='2' maxlength='2' /> / <input type='text' name='day' size='2' maxlength='2' />
	[% IF c.form.error('birthday') %]
	Please type in a valid birthday.
	[% END %]
	</td></tr>
	<tr class='misc1'><td align='right'>Homepage:</td><td><input type='text' name='homepage' size='24' />
	[% IF c.form.error('homepage') %]
	Please type a valid homepage URL.
	[% END %]
	</td></tr>
	<tr class='misc2'><td></td><td><input type='submit' /></td></tr>
	</form>
	</tbody>
</table>
</div>
[% END %]